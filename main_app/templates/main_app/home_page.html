{% extends "base_page.html" %}
{% load static %}
{% block extra_content %}
<link rel="stylesheet" href="{% static 'main_app/css/home_styles.css' %}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
{% endblock %}


{% block main_content %}
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
    new Swiper(".promoSwiper", {
        loop: true,

        autoplay: {
            delay: 4000,
            disableOnInteraction: false,
        },

        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },

        pagination: {
            el: ".swiper-pagination",
            clickable: true,
        },
    });
});
</script>

<div class="main">
  <div class="slider">
    <div class="swiper promoSwiper">
      <div class="swiper-wrapper">

          {% for promo in promotions %}
              {% if promo.promo_photo %}
                  <div class="swiper-slide">
                      <img src="{{ promo.promo_photo.url }}" alt="{{ promo.name }}">
                      <div class="promo-title">{{ promo.name }}</div>
                  </div>
              {% endif %}
          {% endfor %}

      </div>

      <!-- кнопки -->
      <div class="swiper-button-next"></div>
      <div class="swiper-button-prev"></div>

      <!-- точки -->
      <div class="swiper-pagination"></div>
    </div>
  </div>
  <div class="recommendations-container">
    <div class="recommendations-title">
      <h1>Рекомендации</h1>
    </div>
    <div class="products-grid">
      {% for obj in products %}
        <div class="product-container">
          <div class="product-thumb">
            <div class="product-control">
              <form>
                <div class="product-control-button">
                  {% if obj.id not in user_favorites %}
                      <button type="button" class="favorite-btn"
                              data-id="{{ obj.id }}"
                              data-action="add"> <!-- Не менять название класса и не удалять тег с классом, только стили, так как js работает на нем -->
                          <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 16 16" fill="#fff">
                              <path d="M1.24264 8.24264L8 15L14.7574 8.24264C15.553 7.44699 16 6.36786 16 5.24264V5.05234C16 2.8143 14.1857 1 11.9477 1C10.7166 1 9.55233 1.55959 8.78331 2.52086L8 3.5L7.21669 2.52086C6.44767 1.55959 5.28338 1 4.05234 1C1.8143 1 0 2.8143 0 5.05234V5.24264C0 6.36786 0.44699 7.44699 1.24264 8.24264Z"/>
                          </svg>
                      </button>
                  {% else %}
                      <button type="button" class="favorite-btn active"
                              data-id="{{ obj.id }}"
                              data-action="remove"> <!-- Не менять название класса и не удалять тег с классом, только стили, так как js работает на нем -->
                          <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 16 16" fill="#ff0000">
                              <path d="M1.24264 8.24264L8 15L14.7574 8.24264C15.553 7.44699 16 6.36786 16 5.24264V5.05234C16 2.8143 14.1857 1 11.9477 1C10.7166 1 9.55233 1.55959 8.78331 2.52086L8 3.5L7.21669 2.52086C6.44767 1.55959 5.28338 1 4.05234 1C1.8143 1 0 2.8143 0 5.05234V5.24264C0 6.36786 0.44699 7.44699 1.24264 8.24264Z"/>
                          </svg>
                      </button>
                  {% endif %}
                </div>
                <input type="hidden" name="product_id" value="{{ obj.id }}">
              </form>
            </div>
            <div class="product-image">
              <a href="{{ obj.get_absolute_url }}">
                {% with obj.product_photos.first as photo %}
                  {% if photo %}
                    <img src="{{ photo.photo.url }}" alt="{{ obj.name }}">
                  {% else %}
                    <img src="{% static 'main_app/img/1.jpg' %}" alt="no image">
                  {% endif %}
                {% endwith %}
              </a>
            </div>
            <div class="product-information">
              <span class="product-name">{{ obj.name }}</span>
            </div>
            <div class="product-price-and-cart">
              <div class="product-price-container">
                <span class="product-price">
                  {{ obj.price }} руб
                </span>
                <span class="product-price-credit">
                  0 руб/мес
                </span>
              </div>

              {% if obj.id not in user_orders %}
                  <button class="product-add-cart cart-btn"
                          data-id="{{ obj.id }}"
                          data-action="add"> <!-- Не менять название класса и не удалять тег с классом, только стили, так как js работает на нем -->
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                          <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M2.25 3C2.25 2.58579 2.58579 2.25 3 2.25H4.38197C5.04482 2.25 5.65078 2.6245 5.94721 3.21738L5.27639 3.55279L5.94721 3.21738L6.46353 4.25H20.1384C21.0982 4.25 21.6999 5.28685 21.2237 6.12017L17.9391 11.8682C17.6275 12.4135 17.0477 12.75 16.4197 12.75H8.91567L7.59225 14.8675C7.48818 15.034 7.60789 15.25 7.80425 15.25H19C19.4142 15.25 19.75 15.5858 19.75 16C19.75 16.4142 19.4142 16.75 19 16.75H7.80425C6.42974 16.75 5.59176 15.2381 6.32025 14.0725L7.67159 11.9103L5.30898 5.295L4.60557 3.8882C4.56322 3.8035 4.47666 3.75 4.38197 3.75H3C2.58579 3.75 2.25 3.41421 2.25 3ZM7.06427 5.75L9.02855 11.25H16.4197C16.5094 11.25 16.5922 11.2019 16.6368 11.124L19.7076 5.75H7.06427ZM10 19.5C10 20.3284 9.32843 21 8.5 21C7.67157 21 7 20.3284 7 19.5C7 18.6716 7.67157 18 8.5 18C9.32843 18 10 18.6716 10 19.5ZM17.5 21C18.3284 21 19 20.3284 19 19.5C19 18.6716 18.3284 18 17.5 18C16.6716 18 16 18.6716 16 19.5C16 20.3284 16.6716 21 17.5 21Z"
                          fill="#AFAFAF"></path>
                      </svg>
                  </button>
              {% else %}
                  <button class="product-add-cart_active cart-btn"
                          data-id="{{ obj.id }}"
                          data-action="remove"> <!-- Не менять название класса и не удалять тег с классом, только стили, так как js работает на нем -->
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                          <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M2.25 3C2.25 2.58579 2.58579 2.25 3 2.25H4.38197C5.04482 2.25 5.65078 2.6245 5.94721 3.21738L5.27639 3.55279L5.94721 3.21738L6.46353 4.25H20.1384C21.0982 4.25 21.6999 5.28685 21.2237 6.12017L17.9391 11.8682C17.6275 12.4135 17.0477 12.75 16.4197 12.75H8.91567L7.59225 14.8675C7.48818 15.034 7.60789 15.25 7.80425 15.25H19C19.4142 15.25 19.75 15.5858 19.75 16C19.75 16.4142 19.4142 16.75 19 16.75H7.80425C6.42974 16.75 5.59176 15.2381 6.32025 14.0725L7.67159 11.9103L5.30898 5.295L4.60557 3.8882C4.56322 3.8035 4.47666 3.75 4.38197 3.75H3C2.58579 3.75 2.25 3.41421 2.25 3ZM7.06427 5.75L9.02855 11.25H16.4197C16.5094 11.25 16.5922 11.2019 16.6368 11.124L19.7076 5.75H7.06427ZM10 19.5C10 20.3284 9.32843 21 8.5 21C7.67157 21 7 20.3284 7 19.5C7 18.6716 7.67157 18 8.5 18C9.32843 18 10 18.6716 10 19.5ZM17.5 21C18.3284 21 19 20.3284 19 19.5C19 18.6716 18.3284 18 17.5 18C16.6716 18 16 18.6716 16 19.5C16 20.3284 16.6716 21 17.5 21Z"
                          fill="#AFAFAF"></path>
                      </svg>
                  </button>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}